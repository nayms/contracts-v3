README for the Gemforge build process.

Note the folowing files and folders:

- `gemforge.config.cjs` - gemforge [configuration](https://gemforge.xyz/configuration/)
- `gemforge.deployments.json` - deployed contracts and their tx, addresses for every gemforge target
- `.gemforge/` - temporary staging area used by gemforge
- `src/generated` - all code generated by gemforge
- `script/gemforge` - relevant CLI scripts

## Building

To compile contracts:

```
yarn build
```

## Testing

To test contracts:

```
yarn test
```

##Â Devnet

To run the local devnet:

```
yarn anvil
```

## Deployments

A script - `script/gemforge/deploy.js` - is provided as a convenience for handling the Nayms phased deployments flow. You can call this directly or just use `yarn deploy ...`

The current deployment targets:

- `local`: local anvil node
- `testnet`: sepolia
- `mainnet`: mainnet

**1. Setup config**

Create a `.env` and ensure it contains:

```
LOCAL_RPC_URL=
ETH_MAINNET_RPC_URL=
ETH_GOERLI_RPC_URL=
ETH_SEPOLIA_RPC_URL=
ETHERSCAN_API_KEY=
```

Create a `nayms_mnemonic.txt` file and ensure it contains the team mnemonic.

**2. Fresh deployments**

To do a fresh deployment to a given non-mainnet [target](https://gemforge.xyz/configuration/targets/):

```
yarn deploy <target> --fresh
```

To do a fresh deployment to the mainnet target:

```
yarn deploy-mainnet --fresh
```

**3. Upgrades**

To upgrade a deployment on a non-mainnet target:

```
yarn deploy <target>
```

To upgrade the deployment on the mainnet target:

```
yarn deploy-mainnet --upgrade-start
# at this point you will be prompted to sign the enable the upgrade id using the MPC wallet
yarn deploy-mainnet --upgrade-finish
```

## Querying

To see how the current deployed Diamond differs from the compiled code for a target:

```
yarn query <target>
```
